@model IEnumerable<QL_CDC.Models.SelectListModel>

@{ ViewData["Title"] = "ThemSanPham";
    Layout = "~/Views/Shared/_SecondLayout.cshtml"; }

<!-- build:js assets/vendor/js/core.js -->
<script src="/template/sneat//assets/vendor/js/bootstrap.js"></script>

<div class="container-fluid pt-5" style=" margin-top: -40px; margin-left: 0px">
    <!--Ten-->
    <div class="text-left mb-4" style="margin-left:-33px">
        <h4 class=" px-5 " style="font-weight:bold; text-decoration:underline"><span class="px-2"><b>Danh mục/ </b> Đồ điện tử - Điện thoại</span></h4>
    </div>

    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Hãng </label>

        </div>
        <div class="add_input_2" style="width:20%">
            <select class="form-control" id="add_hang" style="font-weight:bold" onchange="Hang()">
                <option value="0" style="text-align:left; " selected disabled>Chọn hãng điện thoại</option>
                <option value="Apple" style="text-align:left; font-weight:bold ">Apple</option>
                <option value="Samsung" style="text-align:left; font-weight:bold ">Samsung</option>
                <option value="Sony" style="text-align:left; font-weight:bold ">Sony</option>
                <option value="Google" style="text-align:left; font-weight:bold ">Google</option>
                <option value="Xiaomi" style="text-align:left; font-weight:bold ">Xiaomi</option>
                <option value="LG" style="text-align:left; font-weight:bold ">LG</option>
                <option value="Huawei" style="text-align:left; font-weight:bold ">Huawei</option>
                <option value="Vivo" style="text-align:left; font-weight:bold ">Vivo</option>
                <option value="Oppo" style="text-align:left; font-weight:bold ">Oppo</option>
                <option value="Asus" style="text-align:left; font-weight:bold ">Asus</option>
                <option value="Realmi" style="text-align:left; font-weight:bold ">Realmi</option>
                <option value="Nokia" style="text-align:left; font-weight:bold ">Nokia</option>
            </select>
        </div>
    </div>
    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Dòng máy </label>

        </div>
        <div class="add_input_2" style="width:20%">
            <select class="form-control" id="add_dongmay" style="font-weight: bold;">
            </select>
        </div>
        <div style="width: 20%">

        </div>
    </div>
    @*<div class="table-themsanpham2">
            <div class="add_label">
                <label>Màu sắc </label>

            </div>
            <div class="add_input_number">
                <input type="text" id="add_mau" class="form-control" placeholder="Đen/ Trắng/ Xanh/ ..." />
            </div>
            <div style="width: 20%">

            </div>
        </div>*@

    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Tiêu đề </label>
        </div>
        <div class="add_input">
            <input type="text" id="add_ten" class="form-control" placeholder="Nhập tiêu đề bài đăng" />
        </div>
    </div>
    <!--Thoi gian, gia-->
    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Giá </label>

        </div>
        <div class="add_input_number">
            <input type="text" id="add_gia" class="form-control" placeholder="VND" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" />
        </div>
        <div style="width: 20%">

        </div>
    </div>
    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Tình trạng </label>

        </div>
        <div class="add_input_2" style="width:20%">
            <select class="form-control" id="add_tinhtrang" style="font-weight: bold">
                <option value="0" style="text-align:left; font-weight:bold ">Mới</option>
                <option value="1" style="text-align:left; font-weight:bold ">Đã sử dụng</option>
            </select>
        </div>
    </div>
    <!--So luong, nsx-->
    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Số lượng </label>

        </div>
        <div class="add_input_number">
            <input type="number" id="add_sl" min="0" class="form-control" placeholder="Đơn vị" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" />
        </div>

        @*<div class="add_label">
                <label>Nhà sản xuất: </label>

            </div>
            <div class="add_input_number">
                <input type="text" id="add_nsx" class="form-control" placeholder="Tên NSX" />
            </div>*@
    </div>

    <!--Hinh anh-->
    <div class="table-themsanpham2">
        <div class="add_label">
            <label>Hình ảnh </label>

        </div>
        <div class="add_input_file">
            <div class="btnaddfile" onclick="document.getElementById('add_file').click()">Tải ảnh lên</div>
            <input style="display: none" type="file" id="add_file" class="form-control add_file" multiple="multiple" accept=".png, .jpg, .jpeg" />
        </div>
    </div>
    <div class="table-themsanpham2" id="add_preview">

    </div>
    <!--Mota-->
    <div class="table-themsanpham" style="margin-top:2vh">
        <div class="add_label" style="width:50%">
            <label>Mô tả sản phẩm </label>
        </div>
    </div>
    <div class="table-themsanpham" style="margin-top:0vh">
        <textarea class="form-control" id="add_mota" placeholder="Chi tiết dòng máy, Tình trạng/ độ mới sản phẩm, Màu sắc, thời gian sử dụng, bảo hành/ sửa chữa/ phụ kiện đi kèm nếu có, ,..."></textarea>
    </div>
    <!--Nut-->
    <div class="table-themsanpham" style="margin-top:2vh;">
        <div style="width:35%"></div>
        <div class="btnaddfile" style="width:30%" onclick="DangSanPham()">Đăng sản phẩm</div>
        <div style="width:35%"></div>
    </div>

</div>



<script>
    // Dang san pham
    function DangSanPham() {
        var tensp = document.getElementById('add_ten').value;
        var mahang = 2;
        var maloai = 21;
        var gia = $('#add_gia').val();
        var tg = $('#add_thoigian').val();
        var sl = $('#add_sl').val();
        var hang = $('#add_hang').val();
        var dongmay = $('#add_dongmay').val();
        var nsx = hang + "(" + dongmay + ")";
        var img = document.getElementById('add_file').files;
        var mota = $('#add_mota').val();

        if (KiemTraDuLieu(tensp, mahang, maloai, gia, tg, sl, nsx, img.length, mota)) {
            var formData = new FormData();
            formData.append("tensp", tensp);
            for (var i = 0; i < img.length; i++) {
                formData.append("img", img[i]);
            }
            formData.append("mahang", mahang);
            formData.append("maloai", maloai);
            formData.append("gia", gia);
            /*formData.append("tg", tg);*/
            formData.append("sl", sl);
            formData.append("nsx", nsx);
            formData.append("mota", mota);

            $.ajax({
                url: '/SanPham/DangSanPham',
                type: 'post',
                async: true,
                dataType: 'json',
                processData: false,
                contentType: false,
                data: formData,
                success: function (data) {
                    alert("Bài đăng đã được thêm vào danh sách chờ duyệt!");
                    window.location.href = '/CuaHang/DanhSachSanPham'
                }
            })
        }
    }
    function KiemTraDuLieu(tensp, mahang, maloai, gia, tg, sl, hang, img, mota) {
        var check = false;
        if (tensp == null || tensp == "") {
            alert("Vui lòng nhập tên sản phẩm")
        }
        else if (gia == null || gia == 0 || gia == 0) {
            alert("Vui lòng nhập giá cho sản phẩm")
        }
        else if (gia == "") {
            alert("Vui lòng chọn hãng điện thoại")
        }
        //else if (tg == null) {
        //    alert("Vui lòng chọn thời gian đã sử dụng")
        //}
        else if (sl == 0 || sl == '0' || sl == null) {
            alert("Vui lòng nhâp số lượng sản phẩm")
        }
        else if (img == 0) {
            alert("Vui lòng thêm ít nhất một tấm ảnh cho sản phẩm")
        }
        else if (img > 10) {
            alert("Vui lòng chọn tối đa 10 tấm ảnh cho sản phẩm")
        }
        else {
            check = true;
        }
        return check;
    }

    // Doi gia
    function commaSeparateNumber(val) {
        while (/(\d+)(\d{3})/.test(val.toString())) {
            val = val.toString().replace(/(\d+)(\d{3})/, '$1' + ',' + '$2');
        }
        return val;
    }
    $('#add_gia').focusout(function () {
        document.getElementById('add_gia').value = commaSeparateNumber($(this).val());
        if (parseInt(document.getElementById('add_gia').value) < 0) document.getElementById('add_gia').value = 0;
    });
    $('#add_sl').focusout(function () {
        var x = parseInt(document.getElementById('add_sl').value);
        if (x < 0) document.getElementById('add_sl').value = 0;
    });
    $('#add_thoigian').focusout(function () {
        var x = parseInt(document.getElementById('add_thoigian').value);
        if (x < 0) document.getElementById('add_thoigian').value = 0;
    });


    function removeOptions(selectElement) {
        var i, L = selectElement.options.length - 1;
        for (i = L; i >= 0; i--) {
            selectElement.remove(i);
        }
    }

    // review hinh anh
    $("#add_file").change(function () {
        document.getElementById('add_preview').innerHTML = "";
        readURL(this, $('#add_preview'));
        if (this.files.length > 5) {
            document.getElementById("add_preview").style.height = "23vh";
        }
        else {
            document.getElementById("add_preview").style.height = "20vh";
        }
    });
    function readURL(input, div) {
        if (input.files) {
            var filesAmount = input.files.length;
            for (i = 0; i < filesAmount; i++) {
                var reader = new FileReader();
                reader.onload = function (event) {
                    $($.parseHTML('<img>')).attr('src', event.target.result).appendTo(div);
                }
                reader.readAsDataURL(input.files[i]);
            }
        }
    }

    //function hienLoai() {
    //    $('#loai').innerHTML = ;
    //}
    //function layHang() {
    //    var a = $('#chonhang').val();
    //    console.log(a);
    //}


    function Hang() {
        var x = $('#add_hang').val();
        console.log(x);
        CapNhatDongMay(x);
    }

    function CapNhatDongMay(hang) {
        if (hang == "Apple") {
            var str = "";
            str += '<option value="iPhone 3G" style="text-align:left" >iPhone 3G</option>';
            str += '<option value="iPhone 4" style="text-align:left" >iPhone 4</option>';
            str += '<option value="iPhone 4S" style="text-align:left" >iPhone 4S</option>';
            str += '<option value="iPhone 5" style="text-align:left" >iPhone 5</option>';
            str += '<option value="iPhone 5S" style="text-align:left" >iPhone 5S</option>';
            str += '<option value="iPhone 6/6 Plus" style="text-align:left" >iPhone 6/6 Plus</option>';
            str += '<option value="iPhone 6S/6S Plus" style="text-align:left" >iPhone 6S/6S Plus</option>';
            str += '<option value="iPhone SE" style="text-align:left" >iPhone SE</option>';
            str += '<option value="iPhone 7/7 Plus" style="text-align:left" >iPhone 7/7 Plus</option>';
            str += '<option value="iPhone 8/8 Plus" style="text-align:left" >iPhone 8/8 Plus</option>';
            str += '<option value="iPhone X" style="text-align:left" >iPhone X</option>';
            str += '<option value="iPhone Xs/ Xs Max/ Xr" style="text-align:left" >iPhone Xs/ Xs Max/ Xr</option>';
            str += '<option value="iPhone 11 Series" style="text-align:left" >iPhone 11 Series</option>';
            str += '<option value="iPhone 12 Series" style="text-align:left" >iPhone 12 Series</option>';
            str += '<option value="iPhone 13 Series" style="text-align:left" >iPhone 13 Series</option>';
            str += '<option value="iPhone 14 Series" style="text-align:left" >iPhone 14 Series</option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }

        else if (hang == "Samsung") {
            var str = "";
            str += '<option value="Galaxy Note" style="text-align:left" >Galaxy Note</option>';
            str += '<option value="Galaxy S" style="text-align:left" >Galaxy S</option>';
            str += '<option value="Galaxy A" style="text-align:left" >Galaxy A</option>';
            str += '<option value="Galaxy M" style="text-align:left" >Galaxy M</option>';
            str += '<option value="Galaxy Z" style="text-align:left" >Galaxy Z</option>';
            str += '<option value="Dòng khác" style="text-align:left" >Dòng khác</option>';
            document.getElementById('add_dongmay').innerHTML = str;
        }

        else if (hang == "Sony") {
            var str = "";
            str += '<option value="Sony Xperia 1" style="text-align:left" >Sony Xperia 1</option>';
            str += '<option value="Sony Xperia 3" style="text-align:left" >Sony Xperia 3</option>';
            str += '<option value="Sony Xperia 5" style="text-align:left" >Sony Xperia 5</option>';
            str += '<option value="Sony Xperia 10" style="text-align:left" >Sony Xperia 10</option>';
            str += '<option value="Sony Xperia Z" style="text-align:left" >Sony Xperia Z</option>';
            str += '<option value="Sony Xperia X" style="text-align:left" >Sony Xperia X</option>';
            str += '<option value="Dòng khác" style="text-align:left" >Dòng khác</option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }

        else if (hang == "Google") {
            var str = "";
            str += '<option value="Google Pixel/ Pixel XL" style="text-align:left" >Pixel/ Pixel XL</option>';
            str += '<option value="Pixel 2/ Pixel 2 XL" style="text-align:left" >Pixel 2/ Pixel 2 XL</option>';
            str += '<option value="Pixel 3/ Pixel 3 XL" style="text-align:left" >Pixel 3/ Pixel 3 XL</option>';
            str += '<option value="Pixel 3a/ Pixel 3a XL" style="text-align:left" >Pixel 3a/ Pixel 3a XL</option>';
            str += '<option value="Pixel 4/ Pixel 4 XL" style="text-align:left" >Pixel 4/ Pixel 4 XL</option>';
            str += '<option value="Pixel 4a" style="text-align:left" >Pixel 4a</option>';
            str += '<option value="Pixel 5" style="text-align:left" >Pixel 5</option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }

        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }

        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }
        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }
        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }
        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }
        else if (hang == "Xiaomi") {
            var str = "";
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';
            str += '<option value="" style="text-align:left" ></option>';

            document.getElementById('add_dongmay').innerHTML = str;
        }
    }

    //// Doi select
    //$('#add_mh').change(function () {
    //    CapNhatLoai($(this).val());
    //})
    //function CapNhatLoai(id) {
    //    document.getElementById('add_l').innerHTML = '<option value="0" style="text-align:center" selected disabled>--- Loại sản phẩm ---</option>';
    //    $.ajax({
    //        url: '/SanPham/LoaiDienThoai',
    //        type: 'post',
    //        data: {
    //            id: id
    //        },
    //        async: false,
    //        success: function (data) {
    //            for (var i in data) {
    //                var str = new Option(data[i].name, data[i].id);
    //                $('#add_l').append(str);
    //            }
    //        }
    //    })
    //}

</script>